<?xml version="1.0"?>

<group name="TargetArrayController" title="ODriveController Example">

	<module
		class = "TargetArrayControls"
		name = "Controls"
	/>

	<module 
		class = "ODriveController"
		name = "Controller"
		input_mode  = "3"
		control_mode  = "3"
		input_filter_bandwidth = "2"
		serial_port = "/dev/tty.usbmodem206839A14D4D1"
	/>

	<connection source="Controls.POS_TARGET" target="Controller.POS_TARGET" />

	<view name="ODrive" >
		<button height = "25" width = "100" y = "45" x = "10" label="Left" title="Left" command="Controls.left" />
		<button height = "25" width = "100" y = "45" x = "230" label="Right" title="Right" command="Controls.right" />
		<button height = "25" width = "100" y = "10" x = "120" label="Forward" title="Forward" command="Controls.forward" />
		<button height = "25" width = "100" y = "80" x = "120" label="Backward" title="Back" command="Controls.backward" />
		<button height = "25" width = "100" y = "10" x = "10" label="Forward Left" title="Forward Left" command="Controls.forward_left" />
		<button height = "25" width = "100" y = "10" x = "230" label="Forward Right" title="Forward Right" command="Controls.forward_right" />
		<button height = "25" width = "100" y = "80" x = "10" label="Backward Left" title="Backward Left" command="Controls.backward_left" />
		<button height = "25" width = "100" y = "80" x = "230" label="Backward Right" title="Backward Right" command="Controls.backward_right" />

		<grid width="600" height="600" show_title = "true" flipYAxis="true" flipYCanvas="no" title= "Measured gridmap state" direction = "horizontal" source = "GridMatrix.GRID_MATRIX" x = "100" y = "125" valueLow="0" valueHigh="1"/>

		<grid width="600" height="600" show_title = "true" flipYAxis="true" flipYCanvas="no" title= "Expected gridmap state" direction = "horizontal" source = "SLAM.OCCUPANCY_MAP" x = "800" y = "125" valueLow="0" valueHigh="1" />
	</view>

	<module
		class = "LidarSensor"
		name = "LidarSensor"
		serial_port = "/dev/tty.usbserial-0001"
		baud_rate = "256000"
	/>

	<module
		class = "GridMatrix"
		name = "GridMatrix"
		output_size = "125"
		max_distance = "5"
	/>

	<module
		class = "RaoBlackwellSLAM"
		name = "SLAM"
		output_size = "125"
		max_distance = "5"
		num_particles = "20"
	/>

	<connection source="LidarSensor.R_ARRAY" target="GridMatrix.R_ARRAY" delay="0" />
	<connection source="LidarSensor.THETA_ARRAY" target="GridMatrix.THETA_ARRAY" delay="0" />
	<connection source="LidarSensor.R_ARRAY" target="SLAM.R_ARRAY" delay="0" />
	<connection source="LidarSensor.THETA_ARRAY" target="SLAM.THETA_ARRAY" delay="0" />
	<connection source="LidarSensor.N_SAMPLES" target="SLAM.N_SAMPLES" delay="0" />
	<connection source="Controller.POS_ESTIM" target="SLAM.POS_ESTIM" delay="0" />
	<connection source="Controller.VEL_ESTIM" target="SLAM.VEL_ESTIM" delay="0" />
</group>
 
